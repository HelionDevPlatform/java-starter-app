<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Java Starter App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/content/bootstrap.css" rel="stylesheet"/>
    <link href="/content/bootstrap-responsive.css" rel="stylesheet"/>
    <link href="/content/style.css" rel="stylesheet"/>
    <link href="/content/shCore.css" rel="stylesheet"/>
    <link href="/content/shThemeDefault.css" rel="stylesheet"/>

    <script src="/scripts/modernizr-2.6.2.js"></script>

    <script src="/scripts/jquery-1.8.2.js"></script>
    <script src="/scripts/jquery-1.9.1.js"></script>

    <script src="/scripts/bootstrap.js"></script>
   
   
    <script src="/scripts/main.js"></script>
    <script src="/scripts/shCore.js"></script>
    <script src="/scripts/shBrushXml.js"></script>
    <script src="/scripts/shBrushPython.js"></script>
    <!--Font-->
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600" rel="stylesheet" type="text/css">
    

</head>
<body>
     <script type="text/javascript">
        SyntaxHighlighter.all();
    </script>
    <div id="header-row">
        <div class="container">
            <div class="row">
                <!--LOGO-->
                <div class="span3"><a class="brand" href="#"><img src="/img/HelionLogo.png" style="padding-top:8px"></a></div>
                <!-- /LOGO -->
                <!-- MAIN NAVIGATION -->
                <div class="span9">
                    <div class="navbar  pull-right">
                        <div class="navbar-inner">
                            <a data-target=".navbar-responsive-collapse" data-toggle="collapse" class="btn btn-navbar"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a>
                            <div class="nav-collapse collapse navbar-responsive-collapse">
                                <ul class="nav">
                                    <li class="active"><a href="/index.html">Home</a></li>

                                    <li><a href="/addservice.html">Add Services</a></li>

                                </ul>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>     
    <!-- MAIN NAVIGATION -->
    <div class="container" style="margin-bottom:30px"> 
        <h2>ALS Services<span style="padding-left:10px;font-size:.6em">(these are built into Cloud Foundry and enabled by your admin)</span></h2>
        <div id="als-service-buttons">

        </div>
        <div class="collapsediv" id="filesystem_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the filesystem service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service filesystem dotnet-starter-filesystem dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>${name}-filesystem:<br />
                    &nbsp;&nbsp;type: filesystem
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="harbor_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the harbor port service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service harbor dotnet-starter-harbor dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-harbor:<br />
                    &nbsp;&nbsp;type: harbor
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="memcached_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the memecached service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service memcached dotnet-starter-memcached dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-memcached:<br />
                    &nbsp;&nbsp;type: memcached
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="mongodb_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
             </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the mongo service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service mongodb dotnet-starter-mongodb dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-mongodb:<br />
                    &nbsp;&nbsp;type: mongodb
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="mysql_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
                <div> 
                <p> in your pom.xml file, list the mysql connector dependency:</p>
                </div>
                <script type="syntaxhighlighter" class="brush: py">
					<![CDATA[
					<project>
						...
						<dependencies>
							...
							<dependency>
        						<groupId>mysql</groupId>
	        					<artifactId>mysql-connector-java</artifactId>
    	    					<version>5.1.21</version>
     						</dependency>
						</dependencies>
					</project>

					]]>
				</script>
				<div>
				<p>In your source code, you would connect to the database by leveraging the credentials stored in the VCAP_SERVICES variable:</p> 
				</div>
                <script type="syntaxhighlighter" class="brush: py">
                    <![CDATA[
					import java.sql.Connection;
					import java.sql.DriverManager;
					
					...

                    Connection dbConnection = null;
        
        			String vcap_services = System.getenv("VCAP_SERVICES");
        
			        if (vcap_services != null && vcap_services.length() > 0) {
            			try {
            				// Use a JSON parser to get the info we need from  the
                			// VCAP_SERVICES environment variable. This variable contains
                			// credentials for all services bound to the application.
                			

                			JsonRootNode root = new JdomParser().parse(vcap_services);

                			JsonNode mysqlNode = root.getNode("mysql");
                			JsonNode credentials = mysqlNode.getNode(0).getNode("credentials");

                			// Grab login info for MySQL from the credentials node
                			String dbname = credentials.getStringValue("name");
                			String hostname = credentials.getStringValue("hostname");
                			String user = credentials.getStringValue("user");
                			String password = credentials.getStringValue("password");
                			String port = credentials.getNumberValue("port");

							// build a mysql URI and create a valid connection

                			String dbUrl = "jdbc:mysql://" +hostname + ":" + port + "/" + dbname;

                			getLogger().debug("JDBC Connection String: "+dbUrl);
                			Class.forName("com.mysql.jdbc.Driver");
                			dbConnection = DriverManager.getConnection(dbUrl, user, password);
                			
							// use the connection to query the database

            				String getContents = "select text_id, contents from text_data";
	    					Statement stmt = dbConnection.createStatement();
	    					ResultSet rs = stmt.executeQuery(getContents);
	    
	    					while(rs.next()) {
	    						Integer id = rs.getInt("text_id");
	    						String contents = rs.getString("contents");
	    						// do something with the contents
	    						...
	    					}
		
            			} catch (Exception e) {
        					getLogger().error(e);
	            			throw(e);
        				}
        			} 
                    ]]>
                </script>
                <div><p>The credentials are exposed in VCAP_SERVICES as follows:</p></div>
            </div>
            <div class="well off">
                <div class="alert alert-success" role="alert">This service was created during the microcloud creation process. The steps below will make it available for your app.</div>
                <p>To create an instance of the mysql service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service mysql dotnet-starter-mysql dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-mysql:<br />
                    &nbsp;&nbsp;type: mysql
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="postgresql_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the postgres service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service postgresql dotnet-starter-postgresql dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-postgresql:<br />
                    &nbsp;&nbsp;type: postgresql
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="rabbitmq3_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the rabbit service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service rabbitmq3 dotnet-starter-rabbitmq3 dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-rabbitmq3:<br />
                    &nbsp;&nbsp;type: rabbitmq3
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="mssql2014_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the sql server service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service mssql2014 dotnet-starter-mssql2014 dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-mssql2014:<br />
                    &nbsp;&nbsp;type: mssql2014
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="redis_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the redis service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service redis dotnet-starter-redis dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-redis:<br />
                    &nbsp;&nbsp;type: redis
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <h2>User-Provided Services<span style="padding-left:10px;font-size:.6em">(these are externally provisioned and enabled)</span></h2>
        <div id="buttons">

        </div>
        <div id="found_userprovided_services">
            <div id="userprovided-service-buttons">

            </div>

                <div id='userprovided_divs'>
                    <div id="userprovided-services-howto_div" class="well off" style="display:none">
                        <div class="alert alert-warning" role="alert">
                            No <a href="http://docs.hpcloud.com/devplatform/1.2/helion/user/services/1.2user-provided.html">User Provided Services</a> have been created and bound to this app. Create and bind to one by following the steps below. 
                        </div>
                        <pre>helion create-service user-provided [name of service]</pre>
                        <p>The helion CLI will prompt you to specify credential keys and values (note defaults of hostname, port, password):</p>
                        <pre>Which credentials to use for connections [hostname, port, password]:</pre>
                        <p>
                            You can override these defaults with your own credential keys, separate keys with commas, and the CLI will then prompt you for values of each credential key.<br />
                            When you've created your service, you need to bind it to specific applications
                        </p>
                        <pre>helion bind-service [service name] [application name]</pre>
                    </div>


                </div>

        </div>

    </div>    
   

</body>
</html>